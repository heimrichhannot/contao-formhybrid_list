(function(a){FORMHYBRID_LIST={init:function(){this.initPagination();this.initMasonry();this.initComments();this.initShare();this.initProximitySearch()},initProximitySearch:function(){a('.formhybrid-list[data-fhl-prox-search="1"], .frontendedit-list[data-fhl-prox-search="1"]').each(function(){var d=a(this),b=d.find("form"),c=b.find('input[name="proxUseLocation"]');FORMHYBRID_LIST.initProximitySearchFields(d);c.on("click",function(){if(c.is(":checked")){HASTE_PLUS.getCurrentLocation(function(f,e){b.find('input[name="proxLocation"]').val(f+","+e)})}else{b.find('input[name="proxLocation"]').val("")}FORMHYBRID_LIST.initProximitySearchFields(d)})})},initProximitySearchFields:function(e){var b=[],c=e.find("form"),d=c.find('input[name="proxUseLocation"]');if(e.data("fhlProxSearchCity")){b.push(e.data("fhlProxSearchCity"))}if(e.data("fhlProxSearchPostal")){b.push(e.data("fhlProxSearchPostal"))}if(e.data("fhlProxSearchState")){b.push(e.data("fhlProxSearchState"))}if(e.data("fhlProxSearchCountry")){b.push(e.data("fhlProxSearchCountry"))}a.each(b,function(f,g){if(d.is(":checked")){c.find(".form-group."+g).hide().find("input, select").val("")}else{c.find(".form-group."+g).show()}})},initShare:function(){a(".formhybrid-list .share, .frontendedit-list .share").on("click",function(b){if(typeof bootbox!=="undefined"){var c=a(this);b.preventDefault();a.get(c.attr("href"),function(d){bootbox.alert(c.data("message")+'<br><br><textarea onclick="this.select()" class="form-control">'+d+"</textarea>")})}})},initPagination:function(){a(".formhybrid-list, .frontendedit-list").find(".ajax-pagination").each(function(){var b=a(this).closest(".formhybrid-list, .frontendedit-list"),d=b.find(".items"),c="#"+b.attr("id");b.jscroll({loadingHtml:'<div class="loading"><span>Lade...</span></div>',nextSelector:".ajax-pagination a.next",autoTrigger:b.data("infinitescroll")==1,contentSelector:c,callback:function(){var f=a(this),e=f.find(".item");e.hide();f.imagesLoaded(function(){d.append(e.fadeIn(300));if(b.attr("data-fhl-masonry")==1){d.masonry("appended",e);b.masonry()}d.find(".item").removeClass(function(h,g){var i=g.match(/item_\d+/g);if(i.length>0){return i[0]}});d.find(".item").each(function(h){var g=a(this);a(this).addClass("item_"+h).removeClass("odd even first last");if(h%2==0){g.addClass("even")}else{g.addClass("odd")}if(h==0){g.addClass("first")}if(h==d.find(".item").length-1){g.addClass("last")}});f.find(".ajax-pagination").appendTo(f.closest(".jscroll-inner"));f.remove()})}})})},initMasonry:function(){a('.formhybrid-list[data-fhl-masonry="1"], .frontendedit-list[data-fhl-masonry="1"]').each(function(){var d=a(this).find(".items"),c=a(this).data("masonry-options");var b=d.imagesLoaded(function(){b.masonry({itemSelector:".item"});b.masonry("stamp",b.find(".stamp-item"));b.masonry()})})},initComments:function(){a("body").on("submit",".formhybrid-reader .ce_comments .form form",function(d){var b=a(this),c=b.closest(".formhybrid-reader");b.find('input[type="submit"]').addClass("disabled").attr("disabled","disabled");d.preventDefault();a.ajax({type:b.attr("method"),url:b.attr("action"),data:b.serialize(),success:function(e){a.ajax({type:b.attr("method"),url:b.attr("action"),success:function(f){console.log(f);c.replaceWith(a(f).find(".formhybrid-reader"))}})}})});a("body").on("submit",".formhybrid-reader .ce_comments .actions form",function(d){var b=a(this),c=b.closest(".formhybrid-reader");b.find("button.delete").addClass("disabled").attr("disabled","disabled");d.preventDefault();a.ajax({type:b.attr("method"),url:b.attr("action"),data:b.serialize(),success:function(e){b.closest(".comment_formhybrid_list").fadeOut().remove()}})})}};a(document).ready(function(){FORMHYBRID_LIST.init()})})(jQuery);